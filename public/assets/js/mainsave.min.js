
function validatePasswordMatch() {
    const password = document.getElementById("new_password").value;
    const confirmation = document.getElementById("confirmation").value;
    const errorDiv = document.getElementById("password-error");

    // Règles de complexité du mot de passe
    const regexUpper = /[A-Z]/;
    const regexLower = /[a-z]/;
    const regexDigit = /[0-9]/;
    const regexSpecial = /[^A-Za-z0-9]/;

    if (password !== confirmation) {
        errorDiv.textContent = "Les mots de passe ne correspondent pas.";
        return false;
    }

    if (password.length < 12) {
        errorDiv.textContent = "Le mot de passe doit contenir au moins 12 caractères.";
        return false;
    }

    if (!regexUpper.test(password)) {
        errorDiv.textContent = "Le mot de passe doit contenir au moins une lettre majuscule.";
        return false;
    }

    if (!regexLower.test(password)) {
        errorDiv.textContent = "Le mot de passe doit contenir au moins une lettre minuscule.";
        return false;
    }

    if (!regexDigit.test(password)) {
        errorDiv.textContent = "Le mot de passe doit contenir au moins un chiffre.";
        return false;
    }

    if (!regexSpecial.test(password)) {
        errorDiv.textContent = "Le mot de passe doit contenir au moins un caractère spécial.";
        return false;
    }

    errorDiv.textContent = ""; // Aucun problème
    return true;
}
